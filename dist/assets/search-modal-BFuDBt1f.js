import{B as e,C as t,F as n,M as r,N as i,Tt as a,Xt as o,_t as s,it as c,yt as l,z as u}from"./vue-UmFUivib.js";import{H as d,fn as f,kt as p,nt as m,rn as h}from"./antd-B_p1HNUS.js";import{l as g,p as _}from"./index-BwYHa19M.js";var v={class:`flex flex-wrap gap-3 mb-4`},y=[`onClick`],b={__name:`search-modal`,props:{open:Boolean,type:String,departments:Array},emits:[`update:open`,`select`],setup(_,{emit:b}){let x=_,S=b,C=a(!1),w=a([]),T=a({departmentId:null,yearLevel:null,courseId:null}),E=a([{label:`1st Year`,value:`1st`},{label:`2nd Year`,value:`2nd`},{label:`3rd Year`,value:`3rd`},{label:`4th Year`,value:`4th`}]),D=a([]),O=a([]);async function k(){C.value=!0,w.value=[];try{x.type===`professor`?(w.value=(await g(`/professors`,{params:{department_id:T.value.departmentId}})).data.map(e=>({id:e.id,name:e.name,department:e.department_name})),O.value=[{title:`Name`,dataIndex:`name`,key:`name`},{title:`Department`,dataIndex:`department`,key:`department`}]):x.type===`section`&&(w.value=(await g(`/sections`,{params:{year_level:T.value.yearLevel,course_id:T.value.courseId}})).data.map(e=>({id:e.id,name:e.name,yearLevel:e.year_level,course:e.course_name})),O.value=[{title:`Section`,dataIndex:`name`,key:`name`},{title:`Year Level`,dataIndex:`yearLevel`,key:`yearLevel`},{title:`Course`,dataIndex:`course`,key:`course`}])}catch{p.error(`Failed to fetch data.`)}finally{C.value=!1}}function A(e){S(`select`,e),S(`update:open`,!1)}function j(){S(`update:open`,!1)}async function M(){if(x.type===`section`)try{D.value=(await g(`/courses`)).data.map(e=>({label:e.name,value:e.id}))}catch{p.error(`Failed to load courses.`)}}return s(()=>x.open,e=>{e&&(w.value=[],T.value={departmentId:null,yearLevel:null,courseId:null},M(),x.type===`professor`?O.value=[{title:`Name`,dataIndex:`name`,key:`name`},{title:`Department`,dataIndex:`department`,key:`department`}]:O.value=[{title:`Section`,dataIndex:`name`,key:`name`},{title:`Year Level`,dataIndex:`yearLevel`,key:`yearLevel`},{title:`Course`,dataIndex:`course`,key:`course`}])},{immediate:!0}),(a,s)=>{let p=f,g=h,b=d,x=m;return c(),i(x,{open:_.open,title:_.type===`professor`?`Search Professor`:`Search Section`,width:`700px`,footer:null,onCancel:j},{default:l(()=>[r(`div`,v,[_.type===`professor`?(c(),i(p,{key:0,value:T.value.departmentId,"onUpdate:value":s[0]||=e=>T.value.departmentId=e,options:_.departments,placeholder:`Select Department`,style:{width:`250px`}},null,8,[`value`,`options`])):(c(),n(t,{key:1},[e(p,{value:T.value.yearLevel,"onUpdate:value":s[1]||=e=>T.value.yearLevel=e,options:E.value,placeholder:`Select Year Level`,style:{width:`200px`}},null,8,[`value`,`options`]),e(p,{value:T.value.courseId,"onUpdate:value":s[2]||=e=>T.value.courseId=e,options:D.value,placeholder:`Select Course`,style:{width:`250px`}},null,8,[`value`,`options`])],64)),e(g,{type:`primary`,loading:C.value,onClick:k},{default:l(()=>[...s[3]||=[u(` Search `,-1)]]),_:1},8,[`loading`])]),e(b,{columns:O.value,"data-source":w.value,loading:C.value,"row-key":`id`,size:`middle`,pagination:{pageSize:5},onRowClick:A},{bodyCell:l(({column:e,record:r})=>[e.key===`name`?(c(),n(`a`,{key:0,class:`text-blue-500 hover:underline cursor-pointer`,onClick:e=>A(r)},o(r.name),9,y)):(c(),n(t,{key:1},[u(o(r[e.key]),1)],64))]),_:1},8,[`columns`,`data-source`,`loading`])]),_:1},8,[`open`,`title`])}}},x=_(b,[[`__scopeId`,`data-v-2fc297e1`]]);export{x as t};