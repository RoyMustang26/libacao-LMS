import{B as e,Et as t,H as n,K as r,N as i,Tt as a,V as o,dt as s,h as c,it as l,jt as u,lt as d,v as f,w as p,y as m,yt as h}from"./vue-UmFUivib.js";import{or as g}from"./antd-B_p1HNUS.js";import{N as _,R as v,S as y,_ as b}from"./index-BwYHa19M.js";const x=n({name:`ParentCompConsumer`,setup(e,{slots:t}){let n=c(),i=new Map;return()=>{let e=n.meta?.parentName,a=n.meta?.parentComps;if(e){if(i.has(e))return i.get(e);if(a?.length){let n;for(let e of[...a].reverse()){let i=_(e)?o(e):e;n=n?r(i,null,{default:()=>n}):r(i,null,t)}if(n)return i.set(e,n),n}}return t?.default?.()}}});var S=[`/login`,`/404`,`/403`];const C=f(`multi-tab`,()=>{let e=a([]),n=t(),r=a(null),i=b(),o=a([]),s=y(),c=t=>{if(!t||t.path.startsWith(`/redirect`)||t.path.startsWith(`/common`)||t.path===`/`||S.includes(t.path))return;if(r.value&&setTimeout(()=>{r.value&&=(r.value.loading=!1,null)},500),e.value.some(e=>e.fullPath===t.fullPath)){!o.value.includes(t?.name)&&i.layoutSetting.keepAlive&&t.meta.keepAlive&&t.name&&o.value.push(t.name);return}let n={path:t.path,fullPath:t.fullPath,title:t.meta.title,name:t.name,icon:t.meta.icon,affix:t.meta.affix,locale:t.meta.locale};!o.value.includes(n?.name)&&i.layoutSetting.keepAlive&&t.meta.keepAlive&&t.name&&o.value.push(t.name),e.value.push(n)},l=t=>{if(e.value.length<=1){s.error(`不能关闭最后一个标签页`);return}let r=e.value.findIndex(e=>e.fullPath===t);if(r<0){s.error(`当前页签不存在无法关闭`);return}let a=e.value[r];if(a.fullPath===n.value){let t=r===0?e.value[r+1]:e.value[r-1];n.value=t.fullPath,v.push(t.fullPath)}i.layoutSetting.keepAlive&&a.name&&(o.value=o.value.filter(e=>e!==a.name)),e.value=e.value.filter(e=>e.fullPath!==t)},u=t=>{let n=e.value.find(e=>e.fullPath===t);n&&(o.value=o.value.filter(e=>e!==n.name),n.loading=!0,r.value=n,v.replace(`/redirect/${encodeURIComponent(n.fullPath)}`))},d=e=>{e!==n.value&&v.push(e)};return{list:e,activeKey:n,cacheList:o,close:l,clear:()=>{e.value=[],o.value=[],n.value=void 0,r.value=null},closeLeft:t=>{d(t);let n=e.value.findIndex(e=>e.fullPath===t);e.value.slice(0,n).forEach(e=>{e.affix||l(e.fullPath)})},closeRight:t=>{d(t);let n=e.value.findIndex(e=>e.fullPath===t);e.value.slice(n+1).forEach(e=>{e.affix||l(e.fullPath)})},closeOther:t=>{d(t),e.value.forEach(e=>{e.affix||e.fullPath!==t&&l(e.fullPath)})},refresh:u,switchTab:d,addItem:c}});var w=new Map;function T(){let t=c();return{getComp:n=>{if(!t.name)return n;let r=n?.type?.name,i=t.name;if(w.has(i))return w.get(i);let a=n;if(r&&r===i)return w.set(i,a),a;let o=e(a);return o.type||={},o.type.name=i,w.set(i,o),o}}}var E=n({name:`CustomRouteView`,__name:`route-view`,setup(t){let n=b(),{layoutSetting:r}=m(n),a=C(),{cacheList:o}=m(a),{getComp:c}=T();return(t,n)=>{let a=d(`RouterView`);return l(),i(u(x),null,{default:h(()=>[e(a,null,{default:h(({Component:t,route:n})=>[e(g,{appear:``,name:u(r).animationName,mode:`out-in`},{default:h(()=>[u(r).keepAlive?(l(),i(p,{key:0,include:[...u(o)]},[(l(),i(s(u(c)(t)),{key:n.fullPath}))],1032,[`include`])):(l(),i(s(t),{key:n.fullPath}))]),_:2},1032,[`name`])]),_:1})]),_:1})}}});export{C as n,E as t};