import{B as e,Et as t,F as n,H as r,N as i,P as a,Tt as o,it as s,jt as c,tt as l,wt as u,yt as d,z as f}from"./vue-UmFUivib.js";import{$ as p,At as m,Bn as h,H as g,Hn as _,Nt as v,On as y,Pt as b,Q as x,Rt as S,Ut as C,Vn as w,Y as T,ht as E,kn as D,rn as O}from"./antd-B_p1HNUS.js";import{t as k}from"./_createAssigner-B2ykRWrR.js";import{S as A,c as j,p as M,u as N}from"./index-BwYHa19M.js";import"./context-Bv_Ls97G.js";import{t as P}from"./page-container-Beu2-ok8.js";import{t as F}from"./crud-table-modal-CZBZi0p2.js";var I=Object.prototype.hasOwnProperty,L=k(function(e,t){if(_(t)||w(t)){y(t,h(t),e);return}for(var n in t)I.call(t,n)&&D(e,n,t[n])});async function R(e){return N(`/list/crud-table`,e)}async function z(e){return j(`/list/${e}`)}function B(e){let t=u(L({queryApi:()=>Promise.resolve(),loading:!1,queryParams:{},dataSource:[],rowSelections:{selectedRowKeys:[],selectedRows:[],onChange(e,n){t.rowSelections.selectedRowKeys=e,t.rowSelections.selectedRows=n}},queryOnMounted:!0,pagination:L({pageSize:10,pageSizeOptions:[`10`,`20`,`30`,`40`],current:1,total:0,order:`desc`,column:`createTime`,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`总数据位：${e}`,onChange(e,r){t.pagination.pageSize=r,t.pagination.current=e,n()}},e.pagination),expand:!1,expandChange(){t.expand=!t.expand},beforeQuery(){},afterQuery(e){return e}},e));async function n(){if(!t.loading){t.loading=!0;try{await t.beforeQuery();let{data:e}=await t.queryApi({current:t.pagination.current,pageSize:t.pagination.pageSize,column:t.pagination.column,order:t.pagination.order,...t.queryParams});if(e){let n=await t.afterQuery(e);t.dataSource=n.records??[],t.pagination.total=n.total??0}}catch(e){throw Error(`Query Failed: ${e}`)}finally{t.loading=!1}}}function r(){t.pagination.current=1,t.queryParams={},n()}function i(){t.pagination.current=1,n()}return l(()=>{t.queryOnMounted&&n()}),{query:n,resetQuery:r,initQuery:i,state:t}}var V={key:0,flex:``,"gap-2":``},H=M(r({__name:`crud-table`,setup(r){let l=A(),u=t([{title:`名`,dataIndex:`name`},{title:`值`,dataIndex:`value`},{title:`描述`,dataIndex:`remark`},{title:`操作`,dataIndex:`action`}]),{state:h,initQuery:_,resetQuery:y,query:w}=B({queryApi:R,queryParams:{name:void 0,value:void 0,remark:void 0},afterQuery:e=>(console.log(e),e)}),D=o();async function k(e){if(!e.id)return l.error(`id 不能为空`);try{(await z(e.id)).code===200&&await w(),l.success(`删除成功`)}catch(e){console.log(e)}finally{close()}}function j(){D.value?.open()}function M(e){D.value?.open(e)}return(t,r)=>{let o=E,l=b,w=m,A=O,N=p,I=T,L=v,R=S,z=x,B=g,H=P;return s(),i(H,null,{default:d(()=>[e(R,{"mb-4":``},{default:d(()=>[e(L,{class:`system-crud-wrapper`,"label-col":{span:7},model:c(h).queryParams},{default:d(()=>[e(I,{gutter:[15,0]},{default:d(()=>[e(w,{span:6},{default:d(()=>[e(l,{name:`name`,label:`名`},{default:d(()=>[e(o,{value:c(h).queryParams.name,"onUpdate:value":r[0]||=e=>c(h).queryParams.name=e,placeholder:`请输入名`},null,8,[`value`])]),_:1})]),_:1}),e(w,{span:6},{default:d(()=>[e(l,{name:`value`,label:`值`},{default:d(()=>[e(o,{value:c(h).queryParams.value,"onUpdate:value":r[1]||=e=>c(h).queryParams.value=e,placeholder:`请输入值`},null,8,[`value`])]),_:1})]),_:1}),e(w,{span:6},{default:d(()=>[e(l,{name:`remark`,label:`备注`},{default:d(()=>[e(o,{value:c(h).queryParams.remark,"onUpdate:value":r[2]||=e=>c(h).queryParams.remark=e,placeholder:`请输入备注`},null,8,[`value`])]),_:1})]),_:1}),e(w,{span:6},{default:d(()=>[e(N,{flex:``,"justify-end":``,"w-full":``},{default:d(()=>[e(A,{loading:c(h).loading,type:`primary`,onClick:c(_)},{default:d(()=>[...r[3]||=[f(` 查询 `,-1)]]),_:1},8,[`loading`,`onClick`]),e(A,{loading:c(h).loading,onClick:c(y)},{default:d(()=>[...r[4]||=[f(` 重置 `,-1)]]),_:1},8,[`loading`,`onClick`])]),_:1})]),_:1})]),_:1})]),_:1},8,[`model`])]),_:1}),e(R,{title:`增删改查表格`},{extra:d(()=>[e(N,{size:`middle`},{default:d(()=>[e(A,{type:`primary`,onClick:j},{icon:d(()=>[e(c(C))]),default:d(()=>[r[5]||=f(` 新增 `,-1)]),_:1})]),_:1})]),default:d(()=>[e(B,{"row-key":`id`,"row-selection":c(h).rowSelections,loading:c(h).loading,columns:c(u),"data-source":c(h).dataSource,pagination:c(h).pagination},{bodyCell:d(t=>[t?.column?.dataIndex===`action`?(s(),n(`div`,V,[e(A,{type:`link`,onClick:e=>M(t?.record)},{default:d(()=>[...r[6]||=[f(` 编辑 `,-1)]]),_:1},8,[`onClick`]),e(z,{title:`确定删除该条数据？`,"ok-text":`确定`,"cancel-text":`取消`,onConfirm:e=>k(t?.record)},{default:d(()=>[e(A,{type:`link`},{default:d(()=>[...r[7]||=[f(` 删除 `,-1)]]),_:1})]),_:1},8,[`onConfirm`])])):a(``,!0)]),_:1},8,[`row-selection`,`loading`,`columns`,`data-source`,`pagination`])]),_:1}),e(F,{ref_key:`crudTableModal`,ref:D},null,512)]),_:1})}}}),[[`__scopeId`,`data-v-75ecabca`]]);export{H as default};