import{B as e,F as t,H as n,M as r,Tt as i,Xt as a,it as o,tt as s,wt as c,yt as l,z as u}from"./vue-UmFUivib.js";import{H as d,U as f,kt as p,nt as m,ot as h,rn as g,vt as _}from"./antd-B_p1HNUS.js";import{c as v,l as y}from"./index-BwYHa19M.js";import{t as b}from"./StudentFormModal-CgAnKs1J.js";import{t as x}from"./StudentScheduleDrawer-C7vkVrDR.js";import{t as S}from"./StudentTranscriptDrawer-CfGyTovI.js";var C={class:`p-4`},w={class:`flex justify-between mb-3`},T={class:`flex gap-2`},E={class:`flex justify-end mt-3`},D=n({__name:`index`,setup(n){let D=i([]),O=i(!1),k=i(``),A=c({total:0,current:1,pageSize:10}),j=i(!1),M=i(null),N=i(!1),P=i(!1),F=i(null),I=async()=>{O.value=!0;try{let e=(await y(`/students`,{params:{page:A.current,search:k.value}})).data??{data:[],total:0};D.value=e.data,A.total=e.total}catch{p.error(`Failed to load students.`)}finally{O.value=!1}},L=()=>{M.value=null,j.value=!0},R=e=>{M.value=e,j.value=!0},z=e=>{F.value=e,N.value=!0},B=e=>{F.value=e,P.value=!0},V=e=>{m.confirm({title:`Confirm delete?`,okType:`danger`,onOk:async()=>{try{await v(`/students/${e}`),p.success(`Student deleted.`),I()}catch{p.error(`Delete failed.`)}}})};return s(()=>I()),(n,i)=>{let s=_,c=g,p=f,m=d,v=h;return o(),t(`div`,C,[r(`div`,w,[e(s,{value:k.value,"onUpdate:value":i[0]||=e=>k.value=e,placeholder:`Search students...`,style:{width:`300px`},onSearch:I},null,8,[`value`]),e(c,{type:`primary`,onClick:L},{default:l(()=>[...i[5]||=[u(` Add Student `,-1)]]),_:1})]),e(m,{dataSource:D.value,loading:O.value,pagination:!1,rowKey:`id`,bordered:``},{default:l(()=>[e(p,{title:`Student #`,dataIndex:`student_number`}),e(p,{title:`Name`,key:`name`},{bodyCell:l(({record:e})=>[u(a(e.last_name)+`, `+a(e.first_name),1)]),_:1}),e(p,{title:`Course`,key:`course`},{bodyCell:l(({record:e})=>[u(a(e.course?.course_code||``),1)]),_:1}),e(p,{title:`Year Level`,dataIndex:`year_level`}),e(p,{title:`Actions`,key:`actions`},{bodyCell:l(({record:t})=>[r(`div`,T,[e(c,{size:`small`,onClick:e=>R(t)},{default:l(()=>[...i[6]||=[u(`Edit`,-1)]]),_:1},8,[`onClick`]),e(c,{size:`small`,onClick:e=>z(t.id)},{default:l(()=>[...i[7]||=[u(`Schedule`,-1)]]),_:1},8,[`onClick`]),e(c,{size:`small`,type:`dashed`,onClick:e=>B(t.id)},{default:l(()=>[...i[8]||=[u(`TOR`,-1)]]),_:1},8,[`onClick`]),e(c,{size:`small`,danger:``,onClick:e=>V(t.id)},{default:l(()=>[...i[9]||=[u(`Delete`,-1)]]),_:1},8,[`onClick`])])]),_:1})]),_:1},8,[`dataSource`,`loading`]),r(`div`,E,[e(v,{current:A.current,total:A.total,pageSize:A.pageSize,onChange:i[1]||=e=>{A.current=e,I()}},null,8,[`current`,`total`,`pageSize`])]),e(b,{visible:j.value,"onUpdate:visible":i[2]||=e=>j.value=e,editData:M.value,onSaved:I},null,8,[`visible`,`editData`]),e(x,{visible:N.value,"onUpdate:visible":i[3]||=e=>N.value=e,studentId:F.value},null,8,[`visible`,`studentId`]),e(S,{visible:P.value,"onUpdate:visible":i[4]||=e=>P.value=e,studentId:F.value},null,8,[`visible`,`studentId`])])}}});export{D as default};